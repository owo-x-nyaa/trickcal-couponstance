#           _________                                             __
#           \_   ___ \  ____  __ ________   ____   ____   _______/  |______    ____   ____  ____
#           /    \  \/ /  _ \|  |  \____ \ /  _ \ /    \ /  ___/\   __\__  \  /    \_/ ___\/ __ \
#           \     \___(  <_> )  |  /  |_> >  <_> )   |  \\___ \  |  |  / __ \|   |  \  \__\  ___/
#            \______  /\____/|____/|   __/ \____/|___|  /____  > |__| (____  /___|  /\___  >___  >
#                   \/             |__|               \/     \/            \/     \/     \/    \/
#     ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀       ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⢤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀      ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡴⠋⠔⣦⠹⣆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀   ⠀⠀⠀⠀⠀⠀⠀⢀⣠⡴⢶⠓⢛⡙⢶⡀⠀⠀⠀⠀⠀⢀⡴⠋⢄⣉⡾⢳⡕⢻⡄⠀⠀⢸⣉⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡤⠤⠤⣤⣀⣀⣀⣤⢴⡞⣯⣳⣌⣡⠞⠉⣇⠀⢻⡀⠀⠀⠀⣠⠞⢁⡘⠄⡾⣀⢈⣹⣎⣷⠀⠀⣾⠉⠙⢏⡛⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⠁⠀⢀⡞⠊⠉⠀⠀⠀⠀⠀⢀⣀⡈⠙⠒⢤⡈⣷⠘⡅⠀⠀⣰⠏⠐⡂⠤⡉⣍⢉⡉⢡⠉⢌⡙⠛⠻⣄⠀⠌⢧⠸⣆⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡴⢒⡛⣝⣻⢧⡲⣤⢒⡟⣦⠄⡀⢂⠐⠠⠀⠄⠀⠉⠙⢦⣀⣈⠳⣄⡏⠀⣰⠋⠄⣱⡬⡶⢋⠩⢤⡘⢆⡚⡔⢢⢍⡒⣌⠳⢬⣄⣠⣙⣯⡙⠛⠶⢤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⠁⢦⡽⠋⠀⠀⡙⡙⠋⡛⠉⡀⠐⢠⡈⢀⠡⠈⡐⠠⢀⠀⠉⢈⡇⠈⢷⡴⠃⢌⠢⠹⣦⣰⣉⠳⡌⣜⠪⡴⣉⠇⣎⠲⣌⢓⡲⣌⠡⣉⢳⡄⠣⠌⢂⡟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡯⢠⠟⠀⠀⢄⡱⢾⡁⠄⡳⣄⠠⣁⢠⡙⢦⣦⣐⣠⣐⣀⣦⠴⠚⠀⠀⣼⠃⡘⠠⢂⠱⡌⣟⢹⠿⣾⣞⢿⣙⡼⣻⡔⡣⢜⢢⡙⣿⢳⣄⠢⠹⣇⢘⡼⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⠇⠀⠠⢈⡞⠁⠀⠳⣤⣑⣩⣟⣾⡿⣽⣻⡷⠾⣟⢫⠉⣶⠀⡄⠀⢰⡇⠀⠄⠐⠀⢢⣹⡇⠚⠘⠣⣛⠿⣮⡙⠟⢧⡽⣬⠶⠝⠁⠀⠻⣦⠡⢹⡞⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡟⠀⢀⠂⡟⠐⢶⡦⠴⠀⠉⠡⠉⢤⠷⠻⠁⠂⠁⣹⠀⠀⢹⣠⠇⠀⢸⡅⠀⠌⠀⠌⡰⣯⡇⠀⣷⠀⠌⠱⣹⠛⠆⠀⠀⠀⠀⠐⠯⠟⠂⢹⡦⢁⢿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⠀⠀⠂⢼⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡤⠖⠋⢁⠠⢀⢸⡏⠀⠀⢸⡆⠈⠔⢨⠐⡡⢿⡇⠠⠙⠶⠮⠟⠁⠀⠀⠀⠀⠀⢀⡀⠀⠀⠀⠘⣧⠃⡌⠳⢦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⠴⠋⠀⠠⠁⣾⠰⠖⠖⣲⠖⠀⠀⠀⠀⠀⢠⣦⡀⠠⠘⡀⠢⢤⠏⠀⠀⠀⠀⣷⠈⢌⡲⠻⣄⣎⠿⣄⠁⢢⠐⢠⣆⠀⠀⠀⠀⠀⠘⢭⠙⠳⠆⠀⡷⡁⠆⡑⢢⣸⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣯⠀⠀⠀⠀⠠⣡⠆⡀⢠⠞⠁⠀⠀⠀⣰⢶⠚⠳⢎⡇⠀⠡⢐⡼⠃⠀⠀⠀⠀⢰⣋⡷⠊⠁⠐⠋⣸⢂⡙⢶⡀⠌⠘⠜⠉⠚⠣⠤⠀⠀⠈⢷⠀⠠⢈⢳⡅⠚⣾⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠓⠿⡷⠀⠀⢡⠏⡀⠔⡀⠎⠠⠁⠀⠉⠛⠲⠭⠒⠋⠀⠀⢠⡞⠀⠀⠀⠀⠀⢀⡿⠉⠀⠀⠀⢀⡤⢹⠄⢂⠆⡙⢦⡀⠀⠀⠀⠀⠀⠀⠠⢁⠂⡌⠐⡄⠂⣿⠠⠙⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡾⠁⠀⠠⢹⡂⠐⠠⠐⡈⠄⠁⠀⠀⠀⠀⠀⠀⠀⠀⢀⡾⣁⡾⠀⠀⠀⣰⠋⠀⠀⠀⠀⠀⣼⣗⠋⢬⡆⢂⠅⣊⣧⠀⡀⠀⠀⠀⠀⠐⠀⠂⠄⠡⠐⣀⡿⡰⠡⠌⢷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡴⠋⠀⠀⡀⠂⣄⠻⣤⣁⠀⡀⠀⠀⢀⠀⡀⡀⠄⡐⣄⣊⡴⣿⡱⣏⢥⠀⢰⠃⠀⠀⠀⠀⢀⣼⢧⣿⢈⠰⡏⢄⠊⣤⢿⢿⡶⣥⣆⣄⣠⣀⣀⢈⣀⣡⠶⢏⡱⢥⠓⡌⠰⢘⠳⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣶⢛⡤⣀⣄⢢⡴⡝⢦⡔⣶⠏⠛⠲⠟⠾⠶⡾⠶⠟⢿⡛⢽⣋⣙⡵⠛⣯⠲⣩⢿⡀⠀⠀⣠⠴⠋⠁⠀⣿⢠⡽⠳⢮⣞⣉⡻⠌⣳⡄⠈⠛⢧⡭⣙⠫⡍⢥⢋⡆⠳⣌⠳⣌⡑⢂⠡⢌⡙⠶⢦⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠻⣾⣴⣳⣬⢷⣻⡽⡞⠋⠁⠀⠀⠀⠀⠀⣻⡵⢦⣀⡞⠁⠠⠉⠁⠠⢀⠙⠷⡵⢮⣷⠷⠋⠁⠀⠀⠀⢀⡟⢉⠐⠠⢀⠈⠌⢀⠘⡄⢷⡴⠚⢶⣷⣈⠳⣌⠣⢎⡜⡱⢌⠳⡰⡘⡄⢃⠄⠢⠌⢂⠩⢙⠺⠦⣤⣤⣤⣄⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠈⠉⠉⠀⠀⢀⡤⣄⣀⡤⠖⠋⠁⠀⢈⡷⠀⠌⠐⠠⠁⠂⠄⢢⠾⡅⠀⠈⠀⠀⠀⠀⠀⢠⡞⠁⡀⠂⡁⠄⢂⠈⠄⠠⢘⡈⣷⡈⠤⠘⠛⢶⣌⣇⢣⡜⣱⢊⠵⣡⠓⣌⠢⠌⡑⡈⠆⡑⢨⠐⠢⠄⡄⢠⢸⡇⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠽⠀⠈⠀⣀⣠⠤⠤⠶⠞⠁⡐⠈⡀⠂⡁⠐⠈⢯⠀⠀⠀⠀⠀⠀⢀⣠⣼⠏⢀⠂⠄⡁⠄⠂⠄⡈⠄⠡⢀⠐⣈⣉⡛⢶⡀⠀⠀⠉⠉⠉⢳⠎⡜⡴⣉⢆⢣⠘⢠⠁⠎⡐⠡⠌⡡⠒⡈⣤⠿⠁⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣏⠀⠀⢀⡾⣩⣤⡐⠠⢀⠐⣦⠀⠂⠄⢁⠠⠁⡈⠘⠧⣤⣠⣤⠶⠞⠋⠁⣾⠌⠠⠐⠠⢀⠂⠡⠐⠀⠄⡑⠊⠋⠉⢈⢉⣬⡝⢻⡄⠀⠀⠀⣻⣎⢱⢢⡑⢎⠦⣉⠂⡜⢠⢁⢣⣘⣤⠷⠛⠉⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠛⠚⢻⡗⠋⢄⠻⣦⠀⠂⣙⡶⠋⢀⠂⢀⠂⠄⢁⠠⠀⠰⡀⣿⠀⠀⠀⢻⡌⠐⠈⠄⠂⠠⠁⢂⠁⠂⠄⠂⠡⠈⣴⢋⠉⠙⠛⢿⣟⣙⣋⠳⡌⢆⠧⣘⢣⠚⡤⢃⡐⠢⡘⠿⢯⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⡴⢶⠋⣿⠠⢉⠄⢢⠘⣷⠛⠁⠠⠐⡀⠐⠠⠐⠈⡀⠄⢁⠢⢡⡟⠀⠀⠀⢸⣇⠈⡐⠈⠠⠁⠌⡀⠌⠐⡈⠠⠁⣼⠃⠀⠀⠀⢠⠏⠀⠈⠉⠳⢮⣇⣎⡱⢊⡵⢡⢣⠐⡡⣐⣢⡼⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⠖⠋⠁⠈⠑⠸⣇⠢⢁⠌⢂⢔⣹⢦⡈⠐⠠⢀⠁⠂⠌⠐⢀⠈⡄⢃⣾⠁⠀⠀⠀⠀⢻⡄⠠⠁⢂⠡⠐⠀⠄⡁⠠⠁⣼⢃⠂⠀⠀⠀⡟⠀⠀⠀⠀⠀⣰⢯⡻⢷⣧⠜⣿⠛⠛⠛⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣎⡁⠀⠈⠹⣏⡶⠞⢻⡄⠊⡄⣣⠞⠁⠌⠳⣆⡁⠠⠈⠐⠠⢁⠂⡜⢠⡿⠁⠀⠀⠀⠀⠀⠈⢷⡀⢁⠂⠠⢈⠐⠠⢀⣡⠾⠉⢷⣶⣤⣂⢸⡃⠀⠀⠀⠀⠀⣩⢿⣹⡟⣣⠚⡜⡻⣦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡾⠁⠈⠁⢰⡀⣠⠟⠀⠀⠈⢳⡌⡴⠉⡳⢄⡀⠁⠌⡙⠳⢮⣤⣥⢦⣱⡼⠋⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⣤⣤⣅⣦⡴⠳⠋⠁⠂⠀⠀⢹⣦⢍⡛⣛⠶⠶⠶⡴⢾⡟⡟⢣⠜⡢⢝⣰⡽⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⠀⣴⢫⡟⣾⣹⢧⣄⠀⠀⠀⠀⣻⠙⠶⣀⡠⠉⠑⣦⠀⠁⠠⣰⠞⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢳⣄⠀⠀⠀⠀⢀⣠⠴⠊⠉⣿⠳⠷⠾⣽⣮⣵⣶⣼⣼⠷⠾⠛⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢽⡸⢧⣻⢼⣣⢟⣮⢻⡆⠀⠀⣴⣇⠀⠀⠈⠁⠓⠊⠁⠀⢠⡾⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣾⠲⠒⠋⠉⠀⠀⠀⠀⢈⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣏⡷⣹⣎⢷⣫⢞⣳⡟⠀⢰⣯⢟⣦⣤⣀⣀⠀⢀⣠⡼⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⣆⠀⠀⠀⢀⡶⣞⡿⣹⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠷⣷⣚⣧⣛⣮⠷⠃⠀⠀⠻⠿⣼⣶⣯⡿⡿⠟⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⢿⣾⣻⣝⣧⣿⠽⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠉⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀

import os
import asyncio
from playwright.async_api import async_playwright

# 트릭컬 리바이브 URL
BASE_URL = 'https://game.naver.com'
# 쿠폰 게시판 URL
COUPON_NOTICE_BOARD_URL = 'https://game.naver.com/lounge/Trickcal/board/31'
# IOS 쿠폰 입력 페이지
IOS_COUPON_URL ='https://coupon.a.prod.service.trickcal.io/'

async def couponstance():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        context = await browser.new_context()
        page = await context.new_page()

        # 최신 쿠폰 게시물
        await page.goto(COUPON_NOTICE_BOARD_URL, wait_until='load')
        await page.wait_for_selector('[class^="post_board_detail"]', state='visible')
        recent_post = await page.query_selector('[class^="post_board_detail"]')
        post_link_elem = await recent_post.query_selector('[class^="post_board_title"]')
        post_href = await post_link_elem.get_attribute('href')
        full_url = BASE_URL + post_href

        # 쿠폰 코드
        await page.goto(full_url, wait_until='load')
        await page.wait_for_selector('[class^="se-text-paragraph"]', state='visible')
        elements = await page.query_selector_all('[class^="se-text-paragraph"]')
        coupon_code = None
        for i in range(len(elements) - 1, -1, -1):
            text = await elements[i].text_content()
            if "쿠폰 코드" in text:
                if i + 1 < len(elements):
                    coupon_code = await elements[i + 1].text_content()
                break

        # IOS 쿠폰 입력
        await page.goto(IOS_COUPON_URL, wait_until='load')
        await page.fill('#UserId', os.getenv("UID"))
        await page.fill('#CouponCode', coupon_code)
        await page.click('button[onclick="CouponSubmit()"]')
        await browser.close()

asyncio.run(couponstance())